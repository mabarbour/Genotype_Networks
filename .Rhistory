is.mvformula(galls.mvformula)
galls.mvformula
best.r.sq(galls.mvformula, data = traits_galls.traits)
best.r.sq(galls_galls.traits ~ ., data = traits_galls.traits)
best.r.sq(galls_galls.traits ~ ., data = traits_galls.traits)
best.r.sq(galls_galls.traits ~ traits_galls.traits$C_N_imputed + traits_galls.traits$water_content + traits_galls.traits$sal_tannin.PC1 + traits_galls.traits$cinn.PC1 + traits_galls.traits$cinn.PC2 + traits_galls.traits$flavonOLES.PC1 + traits_galls.traits$flavonOLES.PC2 + traits_galls.traits$flavanonOLES.PC1 + traits_galls.traits$log_size + traits_galls.traits$log_trichomes + traits_galls.traits$Height_resid + traits_galls.traits$Density_resid + traits_galls.traits$SLA_resid)
source('~/Documents/Genotype_Networks/Rscripts/network_management_tree_level.R')
source('~/Documents/miscellaneous_R/ggplot_themes.R')
source('~/Documents/ggnet/bipartite_plot_info.R')
require(ggplot2)
require(gridExtra)
require(dplyr)
require(tidyr)
## create theme for figures
theme_links <- theme_bw() +
theme(axis.title.x = element_text(size = 16, vjust = 0.1),
axis.title.y = element_text(size = 16, vjust = 1),
axis.text = element_text(size = 14),
strip.text = element_text(size = 14),
panel.grid = element_blank(),
legend.position = "none")
point.size.range <- c(1,8)
label.x.pos <- 1.5
label.y.galls <- 23
label.y.gallsize <- 14
label.y.ptoids <- 9.5
label.y.ptism <- 1
ABCD.allgalls <- data.frame(x = rep(label.x.pos,4), y = rep(label.y.galls,4),
variable = c("Leaf gall", "apical-Stem gall",
"Bud gall", "mid-Stem gall"),
labels = c("(A)","(B)","(C)","(D)"))
AB.domgalls <- data.frame(x = rep(label.x.pos,2), y = rep(label.y.galls,2),
variable = c("Leaf gall","Bud gall"),
labels = c("(A)","(B)"))
C.gallsize <- data.frame(x = label.x.pos, y = label.y.gallsize, labels = "(C)")
ABC.domptoids <- data.frame(x = rep(label.x.pos,3), y = rep(label.y.ptoids,3),
Parasitoid = c("Platygaster", "Mesopolobus", "Torymus"),
labels = c("(A)","(B)","(C)"))
D.ptism <- data.frame(x = label.x.pos, y = label.y.ptism, labels = "(D)")
A.linkabund <- data.frame(x = 0.5, y = 10, labels = "(A)")
B.ptism <- data.frame(x = 4.25, y = label.y.ptism, labels = "(B)")
#point.size <- 6
line.widths <- 3 # for link plots
## create color-blind friendly palette with grey (taken from http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/)
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
## change Genotype * to C for plotting aesthetics
levels(tree_level_interaxn_all_plants_traits_size$Genotype)[1] <- "C"
attack.df <- as.data.frame(tree_level_interaxn_all_plants_traits_size) %>%
filter(vLG.height.mean > 0) %>%
#mutate(vLG_Platy.prop = vLG_Platy/vLG_abund,
#      vLG_Mesopol.prop = vLG_Mesopol/vLG_abund,
#     vLG_Tory.prop = vLG_Tory/vLG_abund) %>%
select(vLG.height.mean, vLG_abund, vLG_Platy, vLG_Mesopol, vLG_Tory) %>%
gather(vLG.height.mean, vLG_abund)
attack.df$cut.vLG_abund <- cut(attack.df$vLG_abund, breaks = c(1, 4, 22), include.lowest = TRUE, labels = c("Low leaf gall abundance (1-4 per branch)", "High leaf gall abundance (5 - 22 per branch)"))
ggplot(attack.df, aes(x = vLG.height.mean, y = value/vLG_abund,
color = variable, shape = variable, linetype = variable)) +
geom_point(alpha = 0.5) +
facet_wrap(~ cut.vLG_abund) +
geom_smooth(method = "glm", family = binomial,
aes(weight = vLG_abund), se = FALSE, size = line.widths) + #+
#geom_text(data = B.ptism, aes(x = x, y = y, label = labels), inherit.aes = FALSE) +
xlab("Leaf gall diameter (mm)") + ylab("Proportion parasitized") +
scale_color_manual(values = cbPalette[c(6,4,2)]) +
theme_links
ggplot(attack.df, aes(x = vLG.height.mean, y = value/vLG_abund,
color = variable, shape = variable, linetype = variable)) +
geom_point(alpha = 0.75) +
facet_wrap(~ cut.vLG_abund) +
geom_smooth(method = "glm", family = binomial,
aes(weight = vLG_abund), se = FALSE, size = line.widths) + #+
#geom_text(data = B.ptism, aes(x = x, y = y, label = labels), inherit.aes = FALSE) +
xlab("Leaf gall diameter (mm)") + ylab("Proportion parasitized") +
scale_color_manual(values = cbPalette[c(6,4,2)]) +
theme_links
ggplot(attack.df, aes(x = vLG.height.mean, y = value/vLG_abund,
color = variable, shape = variable, linetype = variable)) +
geom_point(alpha = 0.75, size = 5) +
facet_wrap(~ cut.vLG_abund) +
geom_smooth(method = "glm", family = binomial,
aes(weight = vLG_abund), se = FALSE, size = line.widths) + #+
#geom_text(data = B.ptism, aes(x = x, y = y, label = labels), inherit.aes = FALSE) +
xlab("Leaf gall diameter (mm)") + ylab("Proportion parasitized") +
scale_color_manual(values = cbPalette[c(6,4,2)]) +
theme_links
ggplot(attack.df, aes(x = vLG.height.mean, y = value/vLG_abund,
color = variable, shape = variable, linetype = variable)) +
geom_point(alpha = 0.5, size = 5) +
facet_wrap(~ cut.vLG_abund) +
geom_smooth(method = "glm", family = binomial,
aes(weight = vLG_abund), se = FALSE, size = line.widths) + #+
#geom_text(data = B.ptism, aes(x = x, y = y, label = labels), inherit.aes = FALSE) +
xlab("Leaf gall diameter (mm)") + ylab("Proportion parasitized") +
scale_color_manual(values = cbPalette[c(6,4,2)]) +
theme_links
ggplot(attack.df, aes(x = vLG.height.mean, y = value/vLG_abund,
color = variable, shape = variable, linetype = variable)) +
geom_jitter(alpha = 0.5, size = 5, position = position_jitter(height = 0.05, width = 0)) +
facet_wrap(~ cut.vLG_abund) +
geom_smooth(method = "glm", family = binomial,
aes(weight = vLG_abund), se = FALSE, size = line.widths) + #+
#geom_text(data = B.ptism, aes(x = x, y = y, label = labels), inherit.aes = FALSE) +
xlab("Leaf gall diameter (mm)") + ylab("Proportion parasitized") +
scale_color_manual(values = cbPalette[c(6,4,2)]) +
theme_links
ggplot(attack.df, aes(x = vLG.height.mean, y = value/vLG_abund,
color = variable, shape = variable, linetype = variable)) +
geom_jitter(alpha = 0.5, size = 5, position = position_jitter(height = 0.01, width = 0)) +
facet_wrap(~ cut.vLG_abund) +
geom_smooth(method = "glm", family = binomial,
aes(weight = vLG_abund), se = FALSE, size = line.widths) + #+
#geom_text(data = B.ptism, aes(x = x, y = y, label = labels), inherit.aes = FALSE) +
xlab("Leaf gall diameter (mm)") + ylab("Proportion parasitized") +
scale_color_manual(values = cbPalette[c(6,4,2)]) +
theme_links
ggplot(attack.df, aes(x = vLG.height.mean, y = value/vLG_abund,
color = variable, shape = variable, linetype = variable)) +
geom_jitter(alpha = 0.25, size = 5, position = position_jitter(height = 0.01, width = 0)) +
facet_wrap(~ cut.vLG_abund) +
geom_smooth(method = "glm", family = binomial,
aes(weight = vLG_abund), se = FALSE, size = line.widths) + #+
#geom_text(data = B.ptism, aes(x = x, y = y, label = labels), inherit.aes = FALSE) +
xlab("Leaf gall diameter (mm)") + ylab("Proportion parasitized") +
scale_color_manual(values = cbPalette[c(6,4,2)]) +
theme_links
B.ptism
AB.ptism <- data.frame(x = rep(4.25,2), y = rep(1,2), labels = c("(A)","(B)"))
ggplot(attack.df, aes(x = vLG.height.mean, y = value/vLG_abund,
color = variable, shape = variable, linetype = variable)) +
geom_jitter(alpha = 0.25, size = 5,
position = position_jitter(height = 0.01, width = 0)) +
facet_wrap(~ cut.vLG_abund) +
geom_smooth(method = "glm", family = binomial,
aes(weight = vLG_abund), se = FALSE, size = line.widths) +
geom_text(data = AB.ptism, aes(x = x, y = y, label = labels),
inherit.aes = FALSE) +
xlab("Leaf gall diameter (mm)") + ylab("Proportion of leaf galls parasitized") +
scale_color_manual(values = cbPalette[c(6,4,2)]) +
theme_links
ggplot(attack.df, aes(x = vLG.height.mean, y = value/vLG_abund,
color = variable, shape = variable, linetype = variable)) +
geom_jitter(alpha = 0.25, size = 5,
position = position_jitter(height = 0.01, width = 0)) +
facet_grid(. ~ cut.vLG_abund) +
geom_smooth(method = "glm", family = binomial,
aes(weight = vLG_abund), se = FALSE, size = line.widths) +
geom_text(data = AB.ptism, aes(x = x, y = y, label = labels),
inherit.aes = FALSE) +
xlab("Leaf gall diameter (mm)") + ylab("Proportion of leaf galls parasitized") +
scale_color_manual(values = cbPalette[c(6,4,2)]) +
theme_links
ggplot(vLG_ptized.df.3, aes(x = Genotype, y = vLG_prop.ptized,
size = vLG_abund, fill = type, color = type, shape = type)) +
geom_point() +
scale_shape_manual(values = c(1, 23)) +
scale_color_manual(values = c(cbPalette[1], "black")) +
scale_size(range = point.size.range) +
scale_fill_manual(values = cbPalette[c(1,7)]) +
geom_text(data = D.ptism, aes(x = x, y = y, label = labels), inherit.aes = FALSE) +
ylab("Proportion of leaf galls parasitized") + xlab("") +
theme_links
## calculated the weighted mean of leaf gall parasitism on each genotype. I used the number of galls sampled on each replicate willow as the weight, because these will have a more reliable estimate of mean gall size for that willow.
vLG_ptized.df.2 <- vLG_ptized.df %>%
group_by(Genotype) %>%
summarise(vLG_prop.ptized = weighted.mean(vLG_prop.ptized, vLG_abund,
na.rm = TRUE),
vLG_abund = 15) %>% # point size to use for plotting
mutate(type = "weighted.mean")
## bind the original and summarized data together, then order the genotypes according to median leaf gall abundance
vLG_ptized.df.3 <- rbind.data.frame(vLG_ptized.df.2, vLG_ptized.df)
vLG_ptized.df.3$Genotype <- factor(vLG_ptized.df.3$Genotype, levels = vLG.df.sum$Genotype)
## tidy up the data for visualizing the differences in leaf gall parasitism among willow genotypes.
vLG_ptized.df <- as.data.frame(tree_level_interaxn_all_plants_traits_size) %>%
mutate(vLG_ptized = vLG_Platy + vLG_Tory + vLG_Mesopol + vLG_Eulo + vLG_Mymarid) %>%
mutate(vLG_prop.ptized = vLG_ptized/vLG_abund, type = "mean") %>%
select(Genotype, vLG_prop.ptized, vLG_abund, type)
glm.vLG_ptized <- glm(vLG_prop.ptized ~ Genotype, data = vLG_ptized.df, weights = vLG_abund, family = "quasibinomial")
summary(glm.vLG_ptized)
anova(glm.vLG_ptized, test = "F")
## calculated the weighted mean of leaf gall parasitism on each genotype. I used the number of galls sampled on each replicate willow as the weight, because these will have a more reliable estimate of mean gall size for that willow.
vLG_ptized.df.2 <- vLG_ptized.df %>%
group_by(Genotype) %>%
summarise(vLG_prop.ptized = weighted.mean(vLG_prop.ptized, vLG_abund,
na.rm = TRUE),
vLG_abund = 15) %>% # point size to use for plotting
mutate(type = "weighted.mean")
## bind the original and summarized data together, then order the genotypes according to median leaf gall abundance
vLG_ptized.df.3 <- rbind.data.frame(vLG_ptized.df.2, vLG_ptized.df)
vLG_ptized.df.3$Genotype <- factor(vLG_ptized.df.3$Genotype, levels = vLG.df.sum$Genotype)
## plot leaf gall parasitism among willow genotypes. Size of points correspond to weights used to calculated the weighted mean of leaf gall parasitism for each genotype.
vLG_ptized.plot <- ggplot(vLG_ptized.df.3, aes(x = Genotype, y = vLG_prop.ptized,
size = vLG_abund, fill = type, color = type, shape = type)) +
geom_point() +
scale_shape_manual(values = c(1, 23)) +
scale_color_manual(values = c(cbPalette[1], "black")) +
scale_size(range = point.size.range) +
scale_fill_manual(values = cbPalette[c(1,7)]) +
geom_text(data = D.ptism, aes(x = x, y = y, label = labels), inherit.aes = FALSE) +
ylab("Proportion of leaf galls parasitized") + xlab("") +
theme_links
ggplot(vLG_ptized.df.3, aes(x = Genotype, y = vLG_prop.ptized,
size = vLG_abund, fill = type, color = type, shape = type)) +
geom_point() +
scale_shape_manual(values = c(1, 23)) +
scale_color_manual(values = c(cbPalette[1], "black")) +
scale_size(range = point.size.range) +
scale_fill_manual(values = cbPalette[c(1,7)]) +
geom_text(data = D.ptism, aes(x = x, y = y, label = labels), inherit.aes = FALSE) +
ylab("Proportion of leaf galls parasitized") + xlab("") +
theme_links
ggplot(filter(link.df, Gall == "Leaf gall",
Parasitoid %in% c("Platygaster", "Mesopolobus", "Torymus")),
aes(x = Genotype, y = value, fill = Parasitoid)) +
facet_grid(Parasitoid ~ Gall) +
geom_boxplot() +
geom_text(data = ABC.domptoids, aes(x = x, y = y, label = labels)) +
scale_fill_manual(values = cbPalette[c(6,4,2)]) +
scale_y_continuous(limits = c(0,10), breaks = seq(0,10,2)) +
ylab("Link abundance (#/branch)") + xlab("") +
theme_links
## tidy up data for visualizing differences in link composition among genotypes.
link.df <- as.data.frame(tree_level_interaxn_all_plants_traits_size) %>%
select(Genotype,
vLG_Platy, vLG_Mesopol, vLG_Tory, vLG_Eulo, vLG_Mymarid,
rG_Tory, rG_Eulo, rG_Platy, rG_Mesopol, rG_Lestodip, rG_Mesopol,
aSG_Tory, SG_Platy) %>%
gather(Genotype) %>%
separate(variable, into = c("Gall", "Parasitoid"), sep = "_")
## revalue link composition data from species codes to common/species names
link.df$Gall <- factor(revalue(link.df$Gall, c("vLG" = "Leaf gall",
"rG" = "Bud gall",
"aSG" = "apical-Stem gall",
"SG" = "mid-Stem gall")))
link.df$Gall <- factor(link.df$Gall, levels = c("Leaf gall", "Bud gall", "apical-Stem gall", "mid-Stem gall"))
link.df$Parasitoid <- factor(revalue(link.df$Parasitoid, c("Platy" = "Platygaster",
"Mesopol" = "Mesopolobus",
"Tory" = "Torymus",
"Eulo" = "Eulophid",
"Lestodip" = "Lestodiplosis",
"Mymarid" = "Mymarid")))
link.df$Parasitoid <- factor(link.df$Parasitoid, levels = c("Platygaster",
"Mesopolobus",
"Torymus",
"Eulophid",
"Lestodiplosis",
"Mymarid"))
## order genotypes by mean leaf gall abundance
link.df$Genotype <- factor(link.df$Genotype, levels = vLG.df.sum$Genotype)
## link summary
link.summary <- link.df %>% group_by(Genotype, Gall, Parasitoid) %>% summarise_each(funs(mean)) %>% arrange(Gall)
max(filter(link.summary, Gall == "Leaf gall", Parasitoid == "Platygaster")$value) # 3.7
max(filter(link.summary,  Gall == "Leaf gall", Parasitoid == "Mesopolobus")$value) # 8
max(filter(link.summary,  Gall == "Leaf gall", Parasitoid == "Torymus")$value) # 1.4
## link composition plot for all possible interactions. For supplementary materials.
link.composition.plot <- ggplot(link.df, aes(x = Genotype, y = value, fill = Parasitoid)) +
facet_grid(Parasitoid ~ Gall) +
geom_boxplot() +
scale_fill_manual(values = c(cbPalette[c(6,4,2,5,1)], "black")) +
scale_y_continuous(limits = c(0,10), breaks = seq(0,10,2)) +
ylab("Link abundance (#/branch)") +
theme_links
ggplot(link.df, aes(x = Genotype, y = value, fill = Parasitoid)) +
facet_grid(Parasitoid ~ Gall) +
geom_boxplot() +
scale_fill_manual(values = c(cbPalette[c(6,4,2,5,1)], "black")) +
scale_y_continuous(limits = c(0,10), breaks = seq(0,10,2)) +
ylab("Link abundance (#/branch)") +
theme_links
ggplot(filter(link.df, Gall == "Leaf gall",
Parasitoid %in% c("Platygaster", "Mesopolobus", "Torymus")),
aes(x = Genotype, y = value, fill = Parasitoid)) +
facet_grid(Parasitoid ~ Gall) +
geom_boxplot() +
geom_text(data = ABC.domptoids, aes(x = x, y = y, label = labels)) +
scale_fill_manual(values = cbPalette[c(6,4,2)]) +
scale_y_continuous(limits = c(0,10), breaks = seq(0,10,2)) +
ylab("Link abundance (#/branch)") + xlab("") +
theme_links
ggplot(attack.df, aes(x = vLG.height.mean, y = value/vLG_abund,
color = variable, shape = variable, linetype = variable)) +
geom_jitter(alpha = 0.25, size = 5,
position = position_jitter(height = 0.01, width = 0)) +
facet_grid(. ~ cut.vLG_abund) +
geom_smooth(method = "glm", family = binomial,
aes(weight = vLG_abund), se = FALSE, size = line.widths) +
geom_text(data = AB.ptism, aes(x = x, y = y, label = labels)) +
xlab("Leaf gall diameter (mm)") + ylab("Proportion of leaf galls parasitized") +
scale_color_manual(values = cbPalette[c(6,4,2)]) +
theme_links
str(attack.df)
data.frame(x = rep(4.25,2), y = rep(1,2),
labels = c("(A)","(B)"), variable = c("vLG_Platy","vLG_Mesopol","vLG_Tory"))
ggplot(filter(link.df, Gall == "Leaf gall",
Parasitoid %in% c("Platygaster", "Mesopolobus", "Torymus")),
aes(x = Genotype, y = value, fill = Parasitoid)) +
facet_grid(Parasitoid ~ Gall) +
geom_boxplot() +
geom_text(data = ABC.domptoids, aes(x = x, y = y, label = labels)) +
scale_fill_manual(values = cbPalette[c(6,4,2)]) +
scale_y_continuous(limits = c(0,10), breaks = seq(0,10,2)) +
ylab("Link abundance (#/branch)") + xlab("") +
theme_links
ggplot(attack.df, aes(x = vLG.height.mean, y = value/vLG_abund,
color = variable, shape = variable, linetype = variable)) +
geom_point(aes(size = vLG_abund), alpha = 0.5) +
geom_smooth(method = "glm", family = binomial,
aes(weight = vLG_abund), se = FALSE, size = line.widths) +
geom_text(data = B.ptism, aes(x = x, y = y, label = labels), inherit.aes = FALSE) +
xlab("Leaf gall diameter (mm)") + ylab("Proportion parasitized") +
scale_color_manual(values = cbPalette[c(6,4,2)]) +
theme_links
ggplot(attack.df, aes(x = vLG.height.mean, y = value/vLG_abund,
color = variable, shape = variable, linetype = variable)) +
geom_jitter(alpha = 0.25, size = 5,
position = position_jitter(height = 0.01, width = 0)) +
facet_grid(. ~ cut.vLG_abund) +
geom_smooth(method = "glm", family = binomial,
aes(weight = vLG_abund), se = FALSE, size = line.widths) +
geom_text(data = AB.ptism, aes(x = x, y = y, label = labels)) +
xlab("Leaf gall diameter (mm)") + ylab("Proportion of leaf galls parasitized") +
scale_color_manual(values = cbPalette[c(6,4,2)]) +
theme_links
attack.df
AB.ptism <- data.frame(x = rep(4.25,2), y = rep(1,2),
labels = c("(A)","(B)"), cut.vLG_abund = c("Low leaf gall abundance (1-4 per branch)", "High leaf gall abundance (5 - 22 per branch)"))
#point.size <- 6
attack.df$cut.vLG_abund <- cut(attack.df$vLG_abund, breaks = c(1, 4, 22), include.lowest = TRUE, labels = c("Low leaf gall abundance (1-4 per branch)", "High leaf gall abundance (5 - 22 per branch)"))
ggplot(attack.df, aes(x = vLG.height.mean, y = value/vLG_abund,
color = variable, shape = variable, linetype = variable)) +
geom_jitter(alpha = 0.25, size = 5,
position = position_jitter(height = 0.01, width = 0)) +
facet_grid(. ~ cut.vLG_abund) +
geom_smooth(method = "glm", family = binomial,
aes(weight = vLG_abund), se = FALSE, size = line.widths) +
geom_text(data = AB.ptism, aes(x = x, y = y, label = labels)) +
xlab("Leaf gall diameter (mm)") + ylab("Proportion of leaf galls parasitized") +
scale_color_manual(values = cbPalette[c(6,4,2)]) +
theme_links
ggplot(attack.df, aes(x = vLG.height.mean, y = value/vLG_abund,
color = variable, shape = variable, linetype = variable)) +
geom_jitter(alpha = 0.25, size = 5,
position = position_jitter(height = 0.01, width = 0)) +
facet_grid(. ~ cut.vLG_abund) +
geom_smooth(method = "glm", family = binomial,
aes(weight = vLG_abund), se = FALSE, size = line.widths) +
geom_text(data = AB.ptism, aes(x = x, y = y, label = labels), inherit.aes = FALSE) +
xlab("Leaf gall diameter (mm)") + ylab("Proportion of leaf galls parasitized") +
scale_color_manual(values = cbPalette[c(6,4,2)]) +
theme_links
## load required libraries
require(visreg)
require(ggplot2)
require(grid)
require(dplyr)
require(gridBase)
#require(png)
## upload results from simulation
all.measures <- read.csv("~/Documents/Genotype_Networks/data/food web complexity simulation.csv")
dim(all.measures)[1] # 2221 unique simulations. 2425 simulations originally run
single.complexity.max <- max(filter(all.measures, Number.of.Genotypes == 1)$total_complexity, na.rm = TRUE)
## upload png of food web composition ordination
#ord.png <- readPNG("~/Documents/Genotype_Networks/figures/full.link.composition.png")
#ord.rast <- rasterGrob(ord.png, interpolate = TRUE)
# setup multipanel plot for combining ggplot and base graphics (ordination from "link_composition_plots")
par(mfrow = c(1,2))
plot.new()
vps <- baseViewports()
pushViewport(vps$figure)
vp1 <- plotViewport(margins = c(2.4, 0.75, 3.1, 0) - 1)#c(1.8, 1, 0, 1))
A.total <- data.frame(x = 0.5, y = 2.4, labels = "(A)")
## plot the relationship between genetic variation and total food web complexity (weighted linkage density)
total <- ggplot(all.measures,
aes(x = Number.of.Genotypes, y = total_complexity)) +
geom_hline(yintercept = single.complexity.max, linetype = "dashed") +
geom_jitter(shape = 1, color = "grey", position = position_jitter(width = 0.15, height = NULL)) +
stat_summary(fun.y = mean, geom = "point", color = "steelblue", size = 5) +
xlab("Genotypic diversity (no. of genotypes)") + ylab("Food web complexity index") +
scale_x_continuous(limits = c(0,25), breaks = 1:25) +
scale_y_continuous(limits = c(1,2.4), breaks = seq(1,2.5, by = 0.25)) +
geom_text(data = A.total, aes(x = x, y = y, label = labels),
inherit.aes = FALSE, size = 6) +
theme_bw() +
theme(axis.text.y = element_text(size = 12),
axis.text.x = element_text(size = 10),
axis.title.x = element_text(size = 16, vjust = 0.1),
axis.title.y = element_text(size = 16, vjust = 1),
panel.grid = element_blank())
print(total, vp = vp1)
# then plot ordination in "link_composition_plots.R" and save the figure as a pdf, landscape, 8.5" x 11"
## plot the relationship between genetic variation and willow-gall complexity (weighted linkage density)
ggplot(all.measures,
aes(x = Number.of.Genotypes, y = link.density.plant_gall)) +
geom_jitter(shape = 1, color = "grey", position = position_jitter(width = 0.15, height = NULL)) +
stat_summary(fun.y = mean, geom = "point", color = "steelblue", size = 8) +
xlab("Genetic variation (no. of genotypes)") + ylab("Food web complexity index") +
scale_x_continuous(limits = c(0,25), breaks = 1:25) +
scale_y_continuous(limits = c(1,2.5), breaks = seq(1,2.5, by = 0.25)) +
theme_bw() +
theme(axis.text = element_text(size = 14),
axis.title.x = element_text(size = 16, vjust = 0.1),
axis.title.y = element_text(size = 16, vjust = 1),
panel.grid = element_blank())
## plot the relationship between genetic variation and gall-ptoid complexity (weighted linkage density)
ggplot(all.measures,
aes(x = Number.of.Genotypes, y = link.density.gall_ptoid)) +
geom_jitter(shape = 1, color = "grey", position = position_jitter(width = 0.15, height = NULL)) +
stat_summary(fun.y = mean, geom = "point", color = "steelblue", size = 8) +
xlab("Genetic variation (no. of genotypes)") + ylab("Food web complexity index") +
scale_x_continuous(limits = c(0,25), breaks = 1:25) +
scale_y_continuous(limits = c(1,2.85), breaks = seq(1,2.75, by = 0.25)) +
theme_bw() +
theme(axis.text = element_text(size = 14),
axis.title.x = element_text(size = 16, vjust = 0.1),
axis.title.y = element_text(size = 16, vjust = 1),
panel.grid = element_blank())
## calculate the mean food web complexity for the different levels of genetic variation
web.measures.summary <- all.measures %>%
group_by(Number.of.Genotypes) %>%
summarise(mean.complexity = mean(total_complexity, na.rm = TRUE))
with(web.measures.summary, max(mean.complexity)/min(mean.complexity))
with(web.measures.summary, max(mean.complexity)/single.complexity.max) # 8% higher due to complimentarity effects
max(all.measures$total_complexity, na.rm = TRUE)/single.complexity.max # up to 15% higher due to complimentarity effects.
## linear model with just the mean data.
web.sum.lm <- lm(log(mean.complexity) ~ log(Number.of.Genotypes), data = web.measures.summary)
summary(web.sum.lm) # Need to understand interpretation here.
visreg(web.sum.lm) # not quite there
## linear model with all of the data.
web.lm <- lm(log(total_complexity) ~ log(Number.of.Genotypes), data = all.measures)
summary(web.lm)
visreg(web.lm)
require(mgcv)
web.sum.gam <- gam(mean.complexity ~ Number.of.Genotypes, data = web.measures.summary)
summary(web.sum.gam)
web.sum.gam <- gam(mean.complexity ~ s(Number.of.Genotypes), data = web.measures.summary)
summary(web.sum.gam)
visreg(web.sum.gam)
web.gam <- gam(mean.complexity ~ s(Number.of.Genotypes), data = all.measures)
web.gam <- gam(total_complexity ~ s(Number.of.Genotypes), data = all.measures)
summary(web.gam)
visreg(web.gam)
web.lm <- lm(log(total_complexity) ~ log(Number.of.Genotypes), data = all.measures)
summary(web.lm)
visreg(web.lm)
table(all.measures$Number.of.Genotypes)
## source in required datasets and functions.
source('~/Documents/Genotype_Networks/Rscripts/network_management_tree_level.R')
source('~/Documents/miscellaneous_R/model_diagnostic_functions.R')
#source('~/Documents/miscellaneous_R/jensen_magnitude_function.R')
## load required libraries
library(vegan) # for adonis analysis
library(knitr) # for making tables
library(ggplot2) # for plotting
theme_set(theme_bw()) # customize ggplot for prettier default graphs
library(gridExtra) # for grid.arrange
library(mvabund) # multivariate analysis
library(HH) # for variance inflation factor analysis (vif) in multiple regression
library(visreg) # visualize regression output
## create datasets for analysis
full.df <- tree_level_interaxn_all_plants_traits_size
interaxns_noPont # all gall-parasitoid interactions used for analysis
gall.corrs.df <- full.df %>% select(vLG.height.mean, vLG_abund, rG_abund, aSG_abund)
full.df <- tree_level_interaxn_all_plants_traits_size
## source in required datasets and functions.
source('~/Documents/Genotype_Networks/Rscripts/network_management_tree_level.R')
source('~/Documents/miscellaneous_R/model_diagnostic_functions.R')
#source('~/Documents/miscellaneous_R/jensen_magnitude_function.R')
## load required libraries
library(vegan) # for adonis analysis
library(knitr) # for making tables
library(ggplot2) # for plotting
theme_set(theme_bw()) # customize ggplot for prettier default graphs
library(gridExtra) # for grid.arrange
library(mvabund) # multivariate analysis
library(HH) # for variance inflation factor analysis (vif) in multiple regression
library(visreg) # visualize regression output
## create datasets for analysis
full.df <- tree_level_interaxn_all_plants_traits_size
interaxns_noPont # all gall-parasitoid interactions used for analysis
gall.corrs.df <- full.df %>% select(vLG.height.mean, vLG_abund, rG_abund, aSG_abund)
library(psych)
install.packages("psych")
library(psych)
corr.test(gall.corrs.df, use = "pairwise", method = "pearson")
corr.test(gall.corrs.df, use = "pairwise", method = "spearman")
cars::scatterPlotMatrix(gall.corrs.df)
library(cars)
install.packages("car")
car::scatterPlotMatrix(gall.corrs.df)
library(car)
scatterplotMatrix(gall.corrs.df)
corr.test(gall.corrs.df, use = "pairwise", method = "spearman")
corr.test(gall.corrs.df, use = "pairwise", method = "pearson")
gall.corrs.df <- full.df %>% select(Genotype, vLG.height.mean, vLG.gall.count, vLG_abund, rG_abund, aSG_abund)
gall.corrs.pheno <- select(gall.corrs.df, -Genotype, -vLG.gall.count)
corr.test(gall.corrs.pheno, use = "pairwise", method = "pearson")
gall.corrs.geno <- gall.corrs.df %>%
group_by(Genotype) %>%
summarise(leaf_gall_size = weighted.mean(vLG.height.mean, vLG.gall.count, na.rm = TRUE),
leaf_gall_abund = mean(vLG_abund, na.rm = TRUE),
bud_gall_abund = mean(rG_abund, na.rm = TRUE),
apical_stem_gall_abund = mean(aSG_abund, na.rm = TRUE))
scatterplotMatrix(gall.corrs.geno)
gall.corrs.geno
gall.corrs.geno <- gall.corrs.df %>%
group_by(Genotype) %>%
summarise(leaf_gall_size = weighted.mean(vLG.height.mean, vLG.gall.count, na.rm = TRUE),
leaf_gall_abund = mean(vLG_abund, na.rm = TRUE),
bud_gall_abund = mean(rG_abund, na.rm = TRUE),
apical_stem_gall_abund = mean(aSG_abund, na.rm = TRUE)) %>%
select(leaf_gall_size, leaf_gall_abund, bud_gall_abund, apical_stem_gall_abund)
scatterplotMatrix(gall.corrs.geno)
corr.test(gall.corrs.geno)
